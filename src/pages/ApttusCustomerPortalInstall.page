<apex:page controller="ACPInstallController" readOnly="false">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="{!URLFOR($Resource.ApttusCustomerPortal, 'install/js/lib.js')}"></script>

<apex:stylesheet value="{!URLFOR($Resource.ApttusCustomerPortal, 'install/css/main.css')}" />
<script>
jQuery.noConflict();
 jQuery(document).ready(function(){
 
 /* tabs */
 jQuery('#tab-container').easytabs();
 
 /* modal */
 var triggers = jQuery('.modalInput').overlay({
 
      // some mask tweaks suitable for modal dialogs
      mask: {
        color: '#ebecff',
        loadSpeed: 200,
        opacity: 0.9
      },
 
      closeOnClick: true
  });
});
 
    function redirect(data){
        document.location.href = data;
    }
 
 
</script>
<style>
h1,h2,h3,h4,h5,h6{display:block;}
/* easy tabs */
.etabs { margin: 0; padding: 0; }
.tab {
    display: inline-block;
    zoom:1; *display:inline;
    background: #eee;
    border: solid 1px #999;
    border-bottom: none;
    -moz-border-radius: 6px 6px 0 0;
    -webkit-border-radius: 6px 6px 0 0;
    border-radius: 6px 6px 0 0;

    behavior: {!URLFOR($Resource.ApttusCustomerPortal, '/css/PIE.htc')};
}
.tab a { font-size: 14px; line-height: 2em; display: block; padding: 0 10px; outline: none; }
.tab a:hover { text-decoration: underline; }
.tab.active { background: whiteSmoke; padding-top: 6px; position: relative; top: 1px; border-color: #666; }
.tab a.active { font-weight: bold; }
.tab-container .panel-container {
    border-top: solid #666 1px;
    padding-top: 20px;
}
/* modal */
.modal {
    background-color:#fff;
    display:none;
    width:350px;
    padding:15px;
    text-align:left;
    border:2px solid #333;
    left: 34%;
    
    opacity:0.8;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    -moz-box-shadow: 0 0 50px #ccc;
    -webkit-box-shadow: 0 0 50px #ccc;
  }
.modal h3{
    display: block;
    text-align: center;
}
.modal p.buttons{
    text-align: center;
    margin:20px;
}

.modal p.buttons a{
    margin-right: 10px;
}

.modal .close {
    background-image: url({!URLFOR($Resource.ApttusCustomerPortal, 'install/img/close.png')});
    position: absolute;
    right: -15px;
    top: -15px;
    cursor: pointer;
    height: 35px;
    width: 35px;
}

  /* main */
  
    .install-package a{display:inline-block;}
    .install-package .install-content{padding: 20px 10px 10px 20px;}
    .install-package div{display:block;}
    .install-package{display:block;}
    .install-package *{line-height: 110%;}
    .install-package .install-link{display:block; margin:20px;}
    .install-package .button-link {
        padding: 10px 15px;
        background: #1B5C78;
        color: #FFF;
        font-weight: bold;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        border-radius: 4px;
        border: solid 1px #20538D;
        text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.4);
        -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 1px 1px rgba(0, 0, 0, 0.2);
        -moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 1px 1px rgba(0, 0, 0, 0.2);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 1px 1px rgba(0, 0, 0, 0.2);
        -webkit-transition-duration: 0.2s;
        -moz-transition-duration: 0.2s;
        transition-duration: 0.2s;
    }
    
    .install-package .button-link:hover, 
    .install-package .button-link:focus {
       background: #66AA00;
       border: solid 1px #2A4E77;
       text-decoration: none;
    }
    
    .install-package .button-link:active {
        -webkit-box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.6);
        -moz-box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.6);
        box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.6);
        background: #2E5481;
        border: solid 1px #203E5F;
    }
    
    .install-package .button-link {
        -webkit-user-select:none;
        -moz-user-select:none;
        -ms-user-select:none;
        user-select:none;
    }
</style>
<apex:form >
<c:ApttusCustomerPortalDynamicMenu />
    <div id="tab-container" class="tab-container">
        <ul class='etabs'>
            <apex:variable var="c" value="1" />
            <apex:repeat value="{!categoriesToDisplay}" var="o">
                <li class='tab'>
                    <a href="#tab{!c}" id="tabLink{!c}"><apex:outputText value="{!o}" /></a>
                </li>
                <apex:variable var="c" value="{!VALUE(c) + 1}" />
            </apex:repeat>
        </ul>
        <div class='panel-container'>
            <apex:variable var="i" value="1" />
            <apex:repeat value="{!categoriesToDisplay}" var="tab">
                <div id="tab{!i}">
                
                    <!-- content -->
                    <apex:variable var="j" value="1" />
                    <apex:repeat value="{!packagesToDisplay}" var="o">
                        <apex:outputPanel rendered="{!o.isVisible && tab = o.packageCategory}">
                           
                            <div class="bSubBlock brandSecondaryBrd secondaryPalette install-package">
                                <h3 class="lbHeader">
                                    <apex:outputText value="{!o.title}" />
                                    <br />
                                    <span>
                                        <apex:outputText value="{!o.version}" />
                                        <apex:outputPanel rendered="{!!ISBLANK(o.releaseDate)}">
                                            (<apex:outputText value="{0,date,MM-dd-yyyy}">
                                                <apex:param value="{!o.releaseDate}" />
                                            </apex:outputText>)
                                        </apex:outputPanel>
                                    </span>
                                </h3>
                                <apex:outputPanel rendered="{!!ISBLANK(o.versionInformation) || !ISBLANK(o.information)}">
                                <div class="install-content clearfix lbBody">
                                    <apex:outputText value="{!o.versionInformation}" escape="false" rendered="{!!ISBLANK(o.versionInformation)}"/>
                                    <apex:outputText value="{!o.information}" escape="false" rendered="{!!ISBLANK(o.information)}"/>
                                </div>
                                </apex:outputPanel>

                                <div class="install-link clearfix">


                                <apex:outputPanel rendered="{!!o.isExecutable}">
                                    <p>
                                      <a rel="#tab{!i}Download{!j}" class="button-link clearfix modalInput" style="cursor:pointer"><apex:outputText value="{!$Label.ACPInstallContactModalButton}" /></a>
                                    </p>
                                    
                                    <apex:outputPanel rendered="{!o.userHasThisPackage == true}">
                                    
                                        <div class="modal" id="tab{!i}Download{!j}" style="display:none;">
                                        <a class="close"></a>
                                          <h3>{!o.title}</h3><br />
                                          <p>{!$Label.ACPInstallDownloadModal}</p>
                                          <p class="buttons">
                                          
                                            <apex:commandLink action="{!download}" value="Production" styleClass="button-link clearfix" target="_blank">
                                            
                                                <apex:param value="{!o.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                                <apex:param value="{!o.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                                <apex:param value="Production" assignTo="{!sandboxOrProdution}" name="sandboxOrProdution1"/>
                                            </apex:commandLink>
                                            
                                            <apex:commandLink action="{!download}" value="Sandbox" styleClass="button-link clearfix" target="_blank">
                                            
                                                <apex:param value="{!o.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                                <apex:param value="{!o.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                                <apex:param value="Sandbox" assignTo="{!sandboxOrProdution}" name="sandboxOrProdution2"/>
                                                
                                            </apex:commandLink>
                                            
                                            
                                          </p>
                                        </div>
                                    </apex:outputPanel>
                                    
                                    <apex:outputPanel rendered="{!o.userHasThisPackage == false}">
                                    
                                        <div class="modal" id="tab{!i}Download{!j}" style="display:none;">
                                        <a class="close"></a>
                                          <h3>{!o.title}</h3><br />
                                          <p>{!$Label.ACPInstallContactModal}</p>
                                          <p class="buttons">
                                            <apex:outputLink value="{!o.downloadLink}" styleClass="button-link clearfix">
                                                
                                                {!o.downloadText}
                                                <apex:actionSupport event="onclick" action="{!askForTrack}" rerender="">
                                                    <apex:param value="{!o.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                                    <apex:param value="{!o.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                                </apex:actionSupport>

                                            </apex:outputLink>
                                          </p>
                                        </div>
                                    </apex:outputPanel>
                                    
                                </apex:outputPanel>
                                
                                <apex:outputPanel rendered="{!o.isExecutable}">
                                
                                    <apex:commandLink action="{!download}" value="{!o.downloadText}" styleClass="button-link clearfix" rendered="{!!o.isExecutable}" target="_blank">
                                        
                                            <apex:param value="{!o.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                            <apex:param value="{!o.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                            
                                    </apex:commandLink>
                                        
                                    <apex:commandLink action="{!downloadExe}" value="{!o.downloadText}" styleClass="button-link clearfix" rendered="{!o.isExecutable}" target="_blank">
                                        <apex:param value="{!o.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                        <apex:param value="{!o.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                
                                
                                
                                

                                </div>
                            </div>
                                
                                
                            <apex:outputPanel rendered="{!!ISBLANK(o.latestVersion)}">
                                
                                <div class="install-package bSubBlock brandSecondaryBrd secondaryPalette">
                                    <h3 class="lbHeader">
                                        <apex:outputText value="{!o.latestVersion.title}" /> (NEW)<br />
                                        <span>
                                            <apex:outputText value="{!o.latestVersion.version}" />
                                                <apex:outputPanel rendered="{!!ISBLANK(o.latestVersion.releaseDate)}">
                                                    (<apex:outputText value="{0,date,MM-dd-yyyy}">
                                                        <apex:param value="{!o.latestVersion.releaseDate}" />
                                                    </apex:outputText>)
                                                </apex:outputPanel>
                                        </span>
                                    </h3>
                                    <div class="install-content clearfix lbBody">
                                        <apex:outputText value="{!o.latestVersion.versionInformation}" escape="false" />
                                        <apex:outputText value="{!o.latestVersion.information}" escape="false" />
                                    </div>
                                    <div class="install-link clearfix">
                                    <p>
                                      <a rel="#tab{!i}Download{!j}sub" class="button-link clearfix modalInput" style="cursor:pointer"><apex:outputText value="{!$Label.ACPInstallContactModalButton}" /></a>
                                    </p>

                                        <div class="modal" id="tab{!i}Download{!j}sub" style="display:none;">
                                        <a class="close"></a>
                                          <h3>{!o.title}</h3><br />
                                          <p>{!$Label.ACPInstallDownloadModal}</p>
                                          <p class="buttons">
                                          
                                          <apex:commandLink action="{!download}" value="Production" styleClass="button-link clearfix" target="_blank">
                                            
                                                <apex:param value="{!o.latestVersion.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                                <apex:param value="{!o.latestVersion.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                                <apex:param value="Production" assignTo="{!sandboxOrProdution}" name="sandboxOrProdution1"/>
                                            </apex:commandLink>
                                            
                                            <apex:commandLink action="{!download}" value="Sandbox" styleClass="button-link clearfix" target="_blank">
                                            
                                                <apex:param value="{!o.latestVersion.downloadLink}" assignTo="{!packageUrl}" name="package_url"/>
                                                <apex:param value="{!o.latestVersion.packageVersionId}" assignTo="{!packageVersionId}" name="package_version_id"/>
                                                <apex:param value="Sandbox" assignTo="{!sandboxOrProdution}" name="sandboxOrProdution2"/>
                                                
                                            </apex:commandLink>                                     
                                          </p>
                                        </div>
                                    </div>
                                </div>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:variable var="j" value="{!VALUE(j) + 1}" />
                    </apex:repeat>
                        
                </div>
                <apex:variable var="i" value="{!VALUE(i) + 1}" />
            </apex:repeat>
        </div>
    </div>
        
      
</apex:form>
<script>
jQuery(function() {
   jQuery('<a name="top"/>').insertBefore(jQuery('body').children().eq(0));
   window.location.hash = 'top';
});
</script>
</apex:page>