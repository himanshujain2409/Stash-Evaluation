<apex:page standardController="Opportunity" extensions="OpportunityPopupController">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

	<apex:form >
		<apex:actionFunction name="openModule" action="{!openModule}" />
		<apex:actionFunction name="NoOpenModule" action="{!NoOpenModule}" />
	</apex:form>

	<script type="text/javascript">

		jQuery.noConflict();
		jQuery(function(){

			function ShowPopUp(){
				URL ="{!URLFOR($Resource.IframeHack)}";
				var parms = URL.split('/');
				domain = "{!URLFOR($Action.Opportunity.New, null)}";
				var parmsD = domain.split('/');
				var resourseUrl = "{!URLFOR($Resource.lightbox, 'res/css/lightbox.css')}";
				var resourseId = resourseUrl.split('/')[2];
				document.getElementById("popupHack").src ="https://"+parmsD[2]+URL+"?resourseId="+resourseId+"&oppId={!oppFull.Id}";
				console.log(document.getElementById("popupHack").src);
			}

			ShowPopUp();

		});
	</script>

	<apex:outputPanel rendered="{!NOT(ISNULL(oppFull.Training_Content_Ids__c))}">
	<script type="text/javascript">
	/*
		jQuery.noConflict();
		jQuery(document).ready(function(){

			if(confirm('Hey {!UserName}!\n The Sales Effectiveness team wants to help you Maximize your deal size!\n Based on your current work on {!oppFull.Name}, we want to help grow this  {!oppFull.Amount} deal by 30% AND help get your deal done before your current close date of {!oppFull.CloseDate}!\n This {!ModuleName} is the best way to help you.  Click YES or NO to learn how to win by leveraging best practices from similar won deals!\n')){
				javascript:openInNewWindow('/apex/lmscons__ConsumerDirector?action=LaunchContent&tuId={!tu_item.Id}');
				openModule();
			} else {
				NoOpenModule();
			}
		function openInNewWindow(link){
			window.open (link, "NewWindow","status=1,toolbar=1,resizable=1,scrollbars=1,location=1");
		}
		})
	*/
	</script>
	</apex:outputPanel>

<apex:pageMessages />

<div><iframe id="popupHack" width="800" height="800" frameborder="no"/></div>

</apex:page>